<table id="products_table" class="table table-bordered">
  <thead>
    <tr>
      <th>SKU</th>
      <th>Product Title</th>
      <% if csv_data.present? %>
        <% csv_data.first["suppliers"].each_with_index do |supplier, index| %>
          <th>Supplier Name (<%= index + 1 %>)</th>
          <th>Supplier Cost (<%= index + 1 %>)</th>
        <% end %>
      <% end %>
    </tr>
  </thead>
  <tbody>
    <% if csv_data.present? %>
      <% csv_data.each do |row| %>
        <tr>
          <td><%= row["sku_code"] %></td>
          <td><%= row["product_title"] %></td>
          <% row["suppliers"].each do |supplier| %>
            <td><%= supplier["supplier_name"] %></td>
            <td>
              <%= text_field_tag "supplier_cost[#{row['sku_code']}][#{supplier['supplier_id']}]", supplier["supplier_cost"], class: "form-control" %>
            </td>
            <!-- Hidden fields for Supplier ID and Reference -->
            <td hidden>
              <%= hidden_field_tag "supplier_id[#{row['sku_code']}][#{supplier['supplier_id']}]", supplier["supplier_id"] %>
            </td>
            <td hidden>
              <%= hidden_field_tag "supplier_ref[#{row['sku_code']}][#{supplier['supplier_id']}]", supplier["supplier_ref"] %>
            </td>
          <% end %>
        </tr>
      <% end %>
    <% else %>
      <tr>
        <td colspan="4">No data available. Upload a CSV file.</td>
      </tr>
    <% end %>
  </tbody>
</table>
